<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>IPL Insights – AI Powered Cricket Analytics</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="stylesheet" href="assets/css/style.css" />

<style>
/* --- Homepage Styling --- */
body {
    background: #0c0f1b;
    color: #fff;
    margin: 0;
    font-family: Arial, sans-serif;
}

header {
    text-align: center;
    padding: 30px 10px;
}

header h1 {
    font-size: 32px;
    margin: 0;
    color: #00d9ff;
}

.main-container {
    max-width: 900px;
    margin: 0 auto;
    padding: 20px;
}

.card {
    background: #141829;
    padding: 20px;
    margin: 20px 0;
    border-radius: 14px;
    border: 1px solid #2a2f45;
}

.card h2 {
    margin-top: 0;
    color: #ffd34d;
}

.match-card img {
    width: 100%;
    border-radius: 14px;
    margin-top: 15px;
}

.cta {
    display: block;
    text-align: center;
    margin-top: 18px;
    background: #ffb100;
    color: #000;
    padding: 14px;
    text-decoration: none;
    border-radius: 12px;
    font-weight: bold;
}

.footer {
    text-align: center;
    margin: 40px 0 20px;
    opacity: 0.75;
    font-size: 14px;
}
</style>

</head>
<body>

<header>
    <h1>IPL Insights</h1>
    <p>Real-time AI-powered cricket analytics & match intelligence</p>
</header>

<div class="main-container">

<div id="loading" class="card">
    <h2>Loading Latest Match...</h2>
    <p>Please wait...</p>
</div>

<div id="content" style="display:none;">

    <div class="card" id="match-info"></div>

    <div class="card match-card" id="match-card-img"></div>

    <div class="card" id="form-guide"></div>

    <div class="card" id="pitch"></div>

    <div class="card" id="projected"></div>

    <div class="card" id="probability"></div>

    <div class="card" id="ai-summary"></div>

    <a id="cta-btn" class="cta" href="#" target="_blank">View Full Match Page</a>

</div>

</div>

<div class="footer">© 2025 IPL Insights. AI-driven cricket analytics.</div>


<script>
// ================================
// Load latest match JSON
// ================================
fetch("data/")
    .then(res => res.text())
    .then(text => {
        // Find newest JSON file (latest date)
        const matchFiles = [...text.matchAll(/(\d{4}-\d{2}-\d{2})\.json/g)]
                          .map(m => m[0])
                          .sort()
                          .reverse();

        if (matchFiles.length === 0) {
            document.getElementById("loading").innerHTML =
                "<h2>No Match Data Found</h2>";
            return;
        }

        const latestFile = "data/" + matchFiles[0];

        return fetch(latestFile).then(r => r.json());
    })
    .then(data => {
        if (!data) return;

        document.getElementById("loading").style.display = "none";
        document.getElementById("content").style.display = "block";

        // HEADER MATCH INFO
        document.getElementById("match-info").innerHTML = `
            <h2>${data.teamA} vs ${data.teamB}</h2>
            <p><strong>Date:</strong> ${data.date}</p>
            <p><strong>Venue:</strong> ${data.venue}</p>
        `;

        // MATCH CARD IMG
        document.getElementById("match-card-img").innerHTML = `
            <img src="assets/img/cards/${data.date}.png" alt="Match Card">
        `;

        // FORM GUIDE
        document.getElementById("form-guide").innerHTML = `
            <h2>Form Guide</h2>
            <p>${data.teamA}: ${data.formA_icons}</p>
            <p>${data.teamB}: ${data.formB_icons}</p>
        `;

        // PITCH
        document.getElementById("pitch").innerHTML = `
            <h2>Pitch Report</h2>
            <p>${data.pitch}</p>
        `;

        // PROJECTED SCORE
        document.getElementById("projected").innerHTML = `
            <h2>Projected Score</h2>
            <p>${data.projected}</p>
        `;

        // WIN PROBABILITY
        document.getElementById("probability").innerHTML = `
            <h2>Win Probability (ML Model)</h2>
            <p>${data.teamA}: ${data.ml_probability.teamA_prob}%</p>
            <p>${data.teamB}: ${data.ml_probability.teamB_prob}%</p>
        `;

        // AI SUMMARY
        document.getElementById("ai-summary").innerHTML = `
            <h2>AI Match Prediction</h2>
            <p>${data.ai_summary}</p>
        `;

        // CTA BUTTON: FULL MATCH PAGE
        document.getElementById("cta-btn").href =
            `matches/${data.date}.html`;

    })
    .catch(err => {
        console.error("Error loading match:", err);
        document.getElementById("loading").innerHTML =
            "<h2>Error loading match data.</h2>";
    });
</script>

</body>
</html>
